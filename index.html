<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duyuru KaydÄ±</title>
    <!-- OneSignal v16 SDK -->
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script>
      window.OneSignal = window.OneSignal || [];
      
      const urlParams = new URLSearchParams(window.location.search);
      const uid = urlParams.get('uid');
      const appId = urlParams.get('appid');

      // Butonla tetikleme (v16 uyumlu)
      async function forcePrompt() {
          if (OneSignal.Notifications) {
              await OneSignal.Notifications.requestPermission();
          } else {
              console.log("SDK henÃ¼z hazÄ±r deÄŸil.");
          }
      }

      OneSignal.push(async function() {
          try {
              await OneSignal.init({
                  appId: appId,
                  allowLocalhostAsSecureOrigin: true,
              });

              if (uid) {
                  await OneSignal.login(uid);
                  console.log("KullanÄ±cÄ± login oldu: " + uid);
              }

              // Otomatik izin istemeyi dene (v16)
              if (OneSignal.Notifications) {
                  await OneSignal.Notifications.requestPermission();
              }
          } catch (e) {
              console.error("OneSignal baÅŸlatÄ±lamadÄ±:", e);
          }
      });
    </script>
</head>
<body style="text-align:center; font-family:sans-serif; padding:50px; background-color:#f4f4f4;">
    <div style="background:white; padding:30px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.1); display:inline-block; width:90%; max-width:400px;">
        <h2 style="color:#eb4d4b;">ðŸ”” Duyuru KaydÄ±</h2>
        <p id="status-text">LÃ¼tfen tarayÄ±cÄ±da Ã§Ä±kan <b>"Ä°zin Ver"</b> butonuna basÄ±n.</p>
        <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">
        <button onclick="forcePrompt()" style="padding:15px; background:#007bff; color:white; border:none; border-radius:10px; cursor:pointer; font-weight:bold; width:100%;">
            KUTUCUK GELMEZSE BURAYA TIKLAYIN
        </button>
    </div>
</body>
</html>
